model Integration {
  id                        String                     @id @default(auto()) @map("_id") @db.ObjectId
  createdAt                 DateTime                   @default(now())
  updatedAt                 DateTime                   @updatedAt
  instructor                Instructor                 @relation(fields: [instructorId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  instructorId              String                     @db.ObjectId
  type                      IntegrationType
  data                      Json
  isActive                  Boolean                    @default(true)
  integrationOutboundQueues IntegrationOutboundQueue[]

  @@map("integrations")
}

enum IntegrationType {
  KIT
  WEBHOOK
}

model IntegrationOutboundQueue {
  id            String                         @id @default(auto()) @map("_id") @db.ObjectId
  createdAt     DateTime                       @default(now())
  updatedAt     DateTime                       @updatedAt
  integration   Integration                    @relation(fields: [integrationId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  integrationId String                         @db.ObjectId
  data          Json
  status        IntegrationOutboundQueueStatus @default(PENDING)
  statusMessage String?
  type          IntegrationOutboundQueueType

  @@map("integrations-outbound-queue")
}

enum IntegrationOutboundQueueType {
  PRODUCT_PURCHASE
}

enum IntegrationOutboundQueueStatus {
  PENDING
  PROCESSING
  SUCCESS
  FAILED
}
