model User {
  // Required
  id                         String                      @id @default(auto()) @map("_id") @db.ObjectId
  createdAt                  DateTime                    @default(now())
  updatedAt                  DateTime                    @updatedAt
  email                      String
  name                       String
  firstName                  String?
  lastName                   String?
  connectedInstructorIds     String[]                    @db.ObjectId
  // Optional
  phone                      String?
  phoneCountryCode           String?
  instructor                 Instructor?                 @relation(fields: [instructorId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  instructorId               String?                     @db.ObjectId
  isAdmin                    Boolean?
  accountingId               String?
  origin                     SignupOrigin?
  avatarMediaUrl             String?
  affiliate                  SaasAffiliate?              @relation(fields: [affiliateId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  affiliateId                String?                     @db.ObjectId
  saasAdminUser              SaaSAdminUser?              @relation(fields: [saasAdminUserId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  saasAdminUserId            String?                     @unique @db.ObjectId
  // Relations
  courses                    CourseEnrollment[]
  contactEntries             Contact[]
  membershipClubEnrollments  MembershipClubEnrollment[]
  membershipClubPosts        MembershipClubPost[]
  payments                   Payment[]
  subscriptions              Subscription[]
  productEnrollments         ProductEnrollment[]
  membershipClubPostComments MembershipClubPostComment[]
  instructorAccesses         UserInstructorAccess[]
  notifications              NotificationsUser[]
  invoices                   Invoice[]
  activity                   UserContentActivity[]
  profileCheckList           UserProfileCheckList?

  @@index([name, email])
  @@map("users")
}

type UserProfileCheckList {
  image Boolean?
  phone Boolean?
  name  Boolean?
}

model UserContentActivity {
  id        String                     @id @default(auto()) @map("_id") @db.ObjectId
  createdAt DateTime                   @default(now())
  updatedAt DateTime                   @updatedAt
  user      User                       @relation(fields: [userId], references: [id], onDelete: NoAction)
  userId    String                     @db.ObjectId
  contentId String                     @db.ObjectId
  entries   UserContentActivityEntry[]

  @@map("user-content-activities")
}

model UserContentActivityEntry {
  id                    String                       @id @default(auto()) @map("_id") @db.ObjectId
  createdAt             DateTime                     @default(now())
  updatedAt             DateTime                     @updatedAt
  type                  UserContentActivityEntryType
  contentId             String                       @db.ObjectId
  data                  Json?
  userContentActivity   UserContentActivity          @relation(fields: [userContentActivityId], references: [id], onDelete: NoAction)
  userContentActivityId String                       @db.ObjectId

  @@map("user-content-activity-entries")
}

enum UserContentActivityEntryType {
  PRODUCT_LECTION_VIEWED
  PRODUCT_LECTION_COMPLETED
}

model UserInstructorAccess {
  id           String                   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt    DateTime                 @default(now())
  updatedAt    DateTime                 @updatedAt
  role         UserInstructorAccessRole
  user         User                     @relation(fields: [userId], references: [id], onDelete: NoAction)
  userId       String                   @db.ObjectId
  instructor   Instructor               @relation(fields: [instructorId], references: [id], onDelete: NoAction)
  instructorId String                   @db.ObjectId
}

enum UserInstructorAccessRole {
  ADMIN
}
